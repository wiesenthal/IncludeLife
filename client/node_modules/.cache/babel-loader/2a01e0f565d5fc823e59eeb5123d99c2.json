{"ast":null,"code":"import _toConsumableArray from\"/Users/miles/Documents/github/lifestyleLayout/LifeInclusions/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/miles/Documents/github/lifestyleLayout/LifeInclusions/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// client/src/App.js\nimport React from\"react\";import logo from\"./logo.svg\";import\"./App.css\";import jwtDecode from'jwt-decode';// import { googleAuthenticator } from './auth.js';\nimport{GoogleOAuthProvider,GoogleLogin}from'@react-oauth/google';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Item(props){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),checked=_React$useState2[0],setChecked=_React$useState2[1];function check(){if(!checked){fetch(\"/inclusion-done\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({inclusion_name:props.text,user:props.user})}).then(function(){props.update();setTimeout(function(){return setChecked(false);},500);});}setChecked(!checked);}return/*#__PURE__*/_jsxs(\"div\",{class:\"flex\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:checked,onChange:check}),/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"bold\"},children:props.text}),props.show_count?/*#__PURE__*/_jsxs(\"span\",{style:{color:\"grey\"},children:[\": \",props.done_count]}):null]});}function App(){var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),data=_React$useState4[0],setData=_React$useState4[1];var _React$useState5=React.useState(0),_React$useState6=_slicedToArray(_React$useState5,2),updateCount=_React$useState6[0],setUpdateCount=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),showCount=_React$useState8[0],setShowCount=_React$useState8[1];var _React$useState9=React.useState(getWindowEmail()),_React$useState10=_slicedToArray(_React$useState9,2),user=_React$useState10[0],setUser=_React$useState10[1];var _React$useState11=React.useState(null),_React$useState12=_slicedToArray(_React$useState11,2),clientId=_React$useState12[0],setClientId=_React$useState12[1];var _React$useState13=React.useState(0.9),_React$useState14=_slicedToArray(_React$useState13,2),alpha=_React$useState14[0],setAlpha=_React$useState14[1];function getWindowEmail(){return window.localStorage.getItem('user');}function setWindowEmail(email){window.localStorage.setItem('user',email);setUser(email);}function getTotalDoneCount(){return data.reduce(function(total,inclusion){return total+inclusion.done_count;},0);}function calcProportionDifference(inclusion){var actualProportion=inclusion.done_count/getTotalDoneCount();return actualProportion-inclusion.expected_proportion;}function getOrder(){var d=_toConsumableArray(data).sort(function(a,b){return calcProportionDifference(a)-calcProportionDifference(b);});return d.map(function(inclusion){return inclusion.name;});}function signIn(credentialResponse){var user=jwtDecode(credentialResponse.credential);setWindowEmail(user.email);}React.useEffect(function(){if(user){var checkDataInterval=setInterval(function(){if(user){fetch(\"/get-data?user=\".concat(user,\"&alpha=\").concat(alpha)).then(function(res){return res.json();}).then(function(data){if(data&&data.inclusions){setData(data.inclusions);clearInterval(checkDataInterval);}});}},1000);fetch(\"/get-data?user=\".concat(user,\"&alpha=\").concat(alpha)).then(function(res){return res.json();}).then(function(data){if(data&&data.inclusions){setData(data.inclusions);clearInterval(checkDataInterval);}});}},[user,updateCount,alpha]);React.useEffect(function(){fetch(\"/get-client-id\").then(function(res){return res.json();}).then(function(data){setClientId(data.client_id);});},[]);if(!clientId){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(!user){return/*#__PURE__*/_jsx(GoogleOAuthProvider,{clientId:clientId,children:/*#__PURE__*/_jsx(GoogleLogin,{onSuccess:signIn,onError:function onError(error){return console.log(error);},useOneTap:true,auto_select:true})});}return/*#__PURE__*/_jsx(GoogleOAuthProvider,{clientId:clientId,children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:data?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{id:\"list\",children:getOrder().map(function(inclusion){return/*#__PURE__*/_jsx(Item,{text:inclusion,done_count:data.find(function(inclusionObj){return inclusionObj.name===inclusion;}).done_count,show_count:showCount,update:function update(){return setUpdateCount(updateCount+1);},user:user},inclusion);})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setShowCount(!showCount);},children:\"Toggle Count Visibility\"}),/*#__PURE__*/_jsx(\"p\",{children:\"How much more valuable are higher-ranked actions than lower-ranked ones?\"}),/*#__PURE__*/_jsx(Slider,{axis:\"x\",x:alpha,onChange:function onChange(_ref){var x=_ref.x;return setAlpha(x);},xmin:0.5,xmax:1.5})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:\"green\"},children:\"Use the below tool to sort a list of activities you value in your life.\"}),/*#__PURE__*/_jsx(\"iframe\",{src:\"./subjectiveSort/index.html?user=\".concat(user)})]})})});}export default App;","map":{"version":3,"names":["React","logo","jwtDecode","GoogleOAuthProvider","GoogleLogin","Item","props","useState","checked","setChecked","check","fetch","method","headers","body","JSON","stringify","inclusion_name","text","user","then","update","setTimeout","fontWeight","show_count","color","done_count","App","data","setData","updateCount","setUpdateCount","showCount","setShowCount","getWindowEmail","setUser","clientId","setClientId","alpha","setAlpha","window","localStorage","getItem","setWindowEmail","email","setItem","getTotalDoneCount","reduce","total","inclusion","calcProportionDifference","actualProportion","expected_proportion","getOrder","d","sort","a","b","map","name","signIn","credentialResponse","credential","useEffect","checkDataInterval","setInterval","res","json","inclusions","clearInterval","client_id","error","console","log","find","inclusionObj","x"],"sources":["/Users/miles/Documents/github/lifestyleLayout/LifeInclusions/client/src/App.js"],"sourcesContent":["// client/src/App.js\n\nimport React from \"react\";\nimport logo from \"./logo.svg\";\nimport \"./App.css\";\n\nimport jwtDecode from 'jwt-decode';\n\n// import { googleAuthenticator } from './auth.js';\nimport { GoogleOAuthProvider, GoogleLogin } from '@react-oauth/google';\n\nfunction Item(props) {\n  const [checked, setChecked] = React.useState(false);\n  function check() {\n    if (!checked) {\n      fetch(\"/inclusion-done\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({inclusion_name: props.text, user: props.user})\n      }).then(() => {\n        props.update();\n        setTimeout(() => setChecked(false), 500);\n      });\n    }\n    setChecked(!checked);\n  }\n  return <div class=\"flex\">\n      <input type=\"checkbox\" checked={checked} onChange={check}/>\n      <span style={{fontWeight: \"bold\"}}>{props.text}</span>\n      {props.show_count? <span style={{color: \"grey\"}}>: {props.done_count}</span> : null}\n    </div>\n}\n\nfunction App() {\n  const [data, setData] = React.useState(null);\n  const [updateCount, setUpdateCount] = React.useState(0);\n  const [showCount, setShowCount] = React.useState(false);\n  const [user, setUser] = React.useState(getWindowEmail());\n  const [clientId, setClientId] = React.useState(null);\n  const [alpha, setAlpha] = React.useState(0.9);\n\n  function getWindowEmail() {\n    return window.localStorage.getItem('user');\n  }\n  \n  function setWindowEmail(email) {\n    window.localStorage.setItem('user', email);\n    setUser(email);\n  }\n\n  function getTotalDoneCount() {\n    return data.reduce((total, inclusion) => total + inclusion.done_count, 0);\n  }\n  function calcProportionDifference(inclusion) {\n    let actualProportion = inclusion.done_count / getTotalDoneCount();\n    return actualProportion - inclusion.expected_proportion;\n  }\n  function getOrder() {\n    let d = [...data].sort((a, b) => calcProportionDifference(a) - calcProportionDifference(b));\n    return d.map(inclusion => inclusion.name);\n  }\n  function signIn(credentialResponse) {\n    let user = jwtDecode(credentialResponse.credential);\n    setWindowEmail(user.email);\n  }\n\n  React.useEffect(() => {\n    if (user) {\n      let checkDataInterval = setInterval(() => {\n        if (user) {\n          fetch(`/get-data?user=${user}&alpha=${alpha}`)\n              .then((res) => res.json())\n              .then((data) => {\n                if (data && data.inclusions) {\n                  setData(data.inclusions);\n                  clearInterval(checkDataInterval);\n                }\n              });\n        }\n      }, 1000);\n      fetch(`/get-data?user=${user}&alpha=${alpha}`)\n              .then((res) => res.json())\n              .then((data) => {\n                if (data && data.inclusions) {\n                  setData(data.inclusions);\n                  clearInterval(checkDataInterval);\n                }\n              });\n    }\n  }, [user, updateCount, alpha]);\n\n  React.useEffect(() => {\n    fetch(\"/get-client-id\")\n      .then((res) => res.json())\n      .then((data) => {\n        setClientId(data.client_id);\n    });\n  }, []);\n\n  if (!clientId) {\n    return <div>Loading...</div>;\n  }\n  if (!user) {\n    return (\n      <GoogleOAuthProvider\n      clientId={clientId}\n      >\n        <GoogleLogin\n          onSuccess={signIn}\n          onError={error => console.log(error)}\n          useOneTap\n          auto_select\n        />\n      </GoogleOAuthProvider>)\n    }\n  \n  return (\n    <GoogleOAuthProvider\n    clientId={clientId}\n    >\n    <div className=\"App\">\n    {data ? \n    <div>\n    <div id=\"list\">\n      {getOrder().map(inclusion => \n        <Item \n        key={inclusion}\n        text={inclusion}\n        done_count={data.find(inclusionObj => inclusionObj.name === inclusion).done_count}\n        show_count = {showCount}\n        update={() => setUpdateCount(updateCount + 1)}\n        user={user}/>\n      )}\n    </div>\n    <button onClick={() => setShowCount(!showCount)}>Toggle Count Visibility</button>\n    <p>How much more valuable are higher-ranked actions than lower-ranked ones?</p>\n    <Slider axis=\"x\" x={alpha} onChange={({ x }) => setAlpha(x)} xmin={0.5} xmax={1.5}/>\n    </div> \n    :\n    <div>\n      <h1 style={{color: \"green\"}}>Use the below tool to sort a list of activities you value in your life.</h1>\n      <iframe src={`./subjectiveSort/index.html?user=${user}`} />\n    </div>\n    }\n    </div>\n    </GoogleOAuthProvider>\n  );\n}\n\nexport default App;"],"mappings":"0TAAA;AAEA,MAAOA,MAAP,KAAkB,OAAlB,CACA,MAAOC,KAAP,KAAiB,YAAjB,CACA,MAAO,WAAP,CAEA,MAAOC,UAAP,KAAsB,YAAtB,CAEA;AACA,OAASC,mBAAT,CAA8BC,WAA9B,KAAiD,qBAAjD,C,wFAEA,QAASC,KAAT,CAAcC,KAAd,CAAqB,CACnB,oBAA8BN,KAAK,CAACO,QAAN,CAAe,KAAf,CAA9B,oDAAOC,OAAP,qBAAgBC,UAAhB,qBACA,QAASC,MAAT,EAAiB,CACf,GAAI,CAACF,OAAL,CAAc,CACZG,KAAK,CAAC,iBAAD,CAAoB,CACvBC,MAAM,CAAE,MADe,CAEvBC,OAAO,CAAE,CACP,eAAgB,kBADT,CAFc,CAKvBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CAACC,cAAc,CAAEX,KAAK,CAACY,IAAvB,CAA6BC,IAAI,CAAEb,KAAK,CAACa,IAAzC,CAAf,CALiB,CAApB,CAAL,CAMGC,IANH,CAMQ,UAAM,CACZd,KAAK,CAACe,MAAN,GACAC,UAAU,CAAC,iBAAMb,WAAU,CAAC,KAAD,CAAhB,EAAD,CAA0B,GAA1B,CAAV,CACD,CATD,EAUD,CACDA,UAAU,CAAC,CAACD,OAAF,CAAV,CACD,CACD,mBAAO,aAAK,KAAK,CAAC,MAAX,wBACH,cAAO,IAAI,CAAC,UAAZ,CAAuB,OAAO,CAAEA,OAAhC,CAAyC,QAAQ,CAAEE,KAAnD,EADG,cAEH,aAAM,KAAK,CAAE,CAACa,UAAU,CAAE,MAAb,CAAb,UAAoCjB,KAAK,CAACY,IAA1C,EAFG,CAGFZ,KAAK,CAACkB,UAAN,cAAkB,cAAM,KAAK,CAAE,CAACC,KAAK,CAAE,MAAR,CAAb,gBAAiCnB,KAAK,CAACoB,UAAvC,GAAlB,CAA8E,IAH5E,GAAP,CAKD,CAED,QAASC,IAAT,EAAe,CACb,qBAAwB3B,KAAK,CAACO,QAAN,CAAe,IAAf,CAAxB,qDAAOqB,IAAP,qBAAaC,OAAb,qBACA,qBAAsC7B,KAAK,CAACO,QAAN,CAAe,CAAf,CAAtC,qDAAOuB,WAAP,qBAAoBC,cAApB,qBACA,qBAAkC/B,KAAK,CAACO,QAAN,CAAe,KAAf,CAAlC,qDAAOyB,SAAP,qBAAkBC,YAAlB,qBACA,qBAAwBjC,KAAK,CAACO,QAAN,CAAe2B,cAAc,EAA7B,CAAxB,sDAAOf,IAAP,sBAAagB,OAAb,sBACA,sBAAgCnC,KAAK,CAACO,QAAN,CAAe,IAAf,CAAhC,uDAAO6B,QAAP,sBAAiBC,WAAjB,sBACA,sBAA0BrC,KAAK,CAACO,QAAN,CAAe,GAAf,CAA1B,uDAAO+B,KAAP,sBAAcC,QAAd,sBAEA,QAASL,eAAT,EAA0B,CACxB,MAAOM,OAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAP,CACD,CAED,QAASC,eAAT,CAAwBC,KAAxB,CAA+B,CAC7BJ,MAAM,CAACC,YAAP,CAAoBI,OAApB,CAA4B,MAA5B,CAAoCD,KAApC,EACAT,OAAO,CAACS,KAAD,CAAP,CACD,CAED,QAASE,kBAAT,EAA6B,CAC3B,MAAOlB,KAAI,CAACmB,MAAL,CAAY,SAACC,KAAD,CAAQC,SAAR,QAAsBD,MAAK,CAAGC,SAAS,CAACvB,UAAxC,EAAZ,CAAgE,CAAhE,CAAP,CACD,CACD,QAASwB,yBAAT,CAAkCD,SAAlC,CAA6C,CAC3C,GAAIE,iBAAgB,CAAGF,SAAS,CAACvB,UAAV,CAAuBoB,iBAAiB,EAA/D,CACA,MAAOK,iBAAgB,CAAGF,SAAS,CAACG,mBAApC,CACD,CACD,QAASC,SAAT,EAAoB,CAClB,GAAIC,EAAC,CAAG,mBAAI1B,IAAJ,EAAU2B,IAAV,CAAe,SAACC,CAAD,CAAIC,CAAJ,QAAUP,yBAAwB,CAACM,CAAD,CAAxB,CAA8BN,wBAAwB,CAACO,CAAD,CAAhE,EAAf,CAAR,CACA,MAAOH,EAAC,CAACI,GAAF,CAAM,SAAAT,SAAS,QAAIA,UAAS,CAACU,IAAd,EAAf,CAAP,CACD,CACD,QAASC,OAAT,CAAgBC,kBAAhB,CAAoC,CAClC,GAAI1C,KAAI,CAAGjB,SAAS,CAAC2D,kBAAkB,CAACC,UAApB,CAApB,CACAnB,cAAc,CAACxB,IAAI,CAACyB,KAAN,CAAd,CACD,CAED5C,KAAK,CAAC+D,SAAN,CAAgB,UAAM,CACpB,GAAI5C,IAAJ,CAAU,CACR,GAAI6C,kBAAiB,CAAGC,WAAW,CAAC,UAAM,CACxC,GAAI9C,IAAJ,CAAU,CACRR,KAAK,0BAAmBQ,IAAnB,mBAAiCmB,KAAjC,EAAL,CACKlB,IADL,CACU,SAAC8C,GAAD,QAASA,IAAG,CAACC,IAAJ,EAAT,EADV,EAEK/C,IAFL,CAEU,SAACQ,IAAD,CAAU,CACd,GAAIA,IAAI,EAAIA,IAAI,CAACwC,UAAjB,CAA6B,CAC3BvC,OAAO,CAACD,IAAI,CAACwC,UAAN,CAAP,CACAC,aAAa,CAACL,iBAAD,CAAb,CACD,CACF,CAPL,EAQD,CACF,CAXkC,CAWhC,IAXgC,CAAnC,CAYArD,KAAK,0BAAmBQ,IAAnB,mBAAiCmB,KAAjC,EAAL,CACSlB,IADT,CACc,SAAC8C,GAAD,QAASA,IAAG,CAACC,IAAJ,EAAT,EADd,EAES/C,IAFT,CAEc,SAACQ,IAAD,CAAU,CACd,GAAIA,IAAI,EAAIA,IAAI,CAACwC,UAAjB,CAA6B,CAC3BvC,OAAO,CAACD,IAAI,CAACwC,UAAN,CAAP,CACAC,aAAa,CAACL,iBAAD,CAAb,CACD,CACF,CAPT,EAQD,CACF,CAvBD,CAuBG,CAAC7C,IAAD,CAAOW,WAAP,CAAoBQ,KAApB,CAvBH,EAyBAtC,KAAK,CAAC+D,SAAN,CAAgB,UAAM,CACpBpD,KAAK,CAAC,gBAAD,CAAL,CACGS,IADH,CACQ,SAAC8C,GAAD,QAASA,IAAG,CAACC,IAAJ,EAAT,EADR,EAEG/C,IAFH,CAEQ,SAACQ,IAAD,CAAU,CACdS,WAAW,CAACT,IAAI,CAAC0C,SAAN,CAAX,CACH,CAJD,EAKD,CAND,CAMG,EANH,EAQA,GAAI,CAAClC,QAAL,CAAe,CACb,mBAAO,mCAAP,CACD,CACD,GAAI,CAACjB,IAAL,CAAW,CACT,mBACE,KAAC,mBAAD,EACA,QAAQ,CAAEiB,QADV,uBAGE,KAAC,WAAD,EACE,SAAS,CAAEwB,MADb,CAEE,OAAO,CAAE,iBAAAW,KAAK,QAAIC,QAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ,EAFhB,CAGE,SAAS,KAHX,CAIE,WAAW,KAJb,EAHF,EADF,CAWC,CAEH,mBACE,KAAC,mBAAD,EACA,QAAQ,CAAEnC,QADV,uBAGA,YAAK,SAAS,CAAC,KAAf,UACCR,IAAI,cACL,oCACA,YAAK,EAAE,CAAC,MAAR,UACGyB,QAAQ,GAAGK,GAAX,CAAe,SAAAT,SAAS,qBACvB,KAAC,IAAD,EAEA,IAAI,CAAEA,SAFN,CAGA,UAAU,CAAErB,IAAI,CAAC8C,IAAL,CAAU,SAAAC,YAAY,QAAIA,aAAY,CAAChB,IAAb,GAAsBV,SAA1B,EAAtB,EAA2DvB,UAHvE,CAIA,UAAU,CAAIM,SAJd,CAKA,MAAM,CAAE,wBAAMD,eAAc,CAACD,WAAW,CAAG,CAAf,CAApB,EALR,CAMA,IAAI,CAAEX,IANN,EACK8B,SADL,CADuB,EAAxB,CADH,EADA,cAYA,eAAQ,OAAO,CAAE,yBAAMhB,aAAY,CAAC,CAACD,SAAF,CAAlB,EAAjB,qCAZA,cAaA,+FAbA,cAcA,KAAC,MAAD,EAAQ,IAAI,CAAC,GAAb,CAAiB,CAAC,CAAEM,KAApB,CAA2B,QAAQ,CAAE,2BAAGsC,EAAH,MAAGA,CAAH,OAAWrC,SAAQ,CAACqC,CAAD,CAAnB,EAArC,CAA6D,IAAI,CAAE,GAAnE,CAAwE,IAAI,CAAE,GAA9E,EAdA,GADK,cAkBL,oCACE,WAAI,KAAK,CAAE,CAACnD,KAAK,CAAE,OAAR,CAAX,qFADF,cAEE,eAAQ,GAAG,4CAAsCN,IAAtC,CAAX,EAFF,GAnBA,EAHA,EADF,CA+BD,CAED,cAAeQ,IAAf"},"metadata":{},"sourceType":"module"}